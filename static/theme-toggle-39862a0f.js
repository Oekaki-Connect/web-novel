(function(){'use strict';const THEME_KEY='preferred-theme';const THEME_ATTR='data-theme';function getSystemTheme(){return window.matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light';}
function getStoredTheme(){return localStorage.getItem(THEME_KEY);}
function setTheme(theme){document.documentElement.setAttribute(THEME_ATTR,theme);localStorage.setItem(THEME_KEY,theme);updateToggleButton(theme);const utterancesContainers=document.querySelectorAll('#utterances-container');utterancesContainers.forEach(container=>{container.innerHTML='';});initializeUtterances();updateUtterancesTheme(theme);}
function getCurrentTheme(){return document.documentElement.getAttribute(THEME_ATTR)||getSystemTheme();}
function toggleTheme(){const currentTheme=getCurrentTheme();const newTheme=currentTheme==='dark'?'light':'dark';setTheme(newTheme);}
function updateToggleButton(theme){const lightOption=document.getElementById('theme-light');const darkOption=document.getElementById('theme-dark');if(lightOption&&darkOption){if(theme==='dark'){lightOption.classList.remove('active');darkOption.classList.add('active');}else{lightOption.classList.add('active');darkOption.classList.remove('active');}}}
function updateUtterancesTheme(theme){const utterancesFrame=document.querySelector('iframe[src*="utteranc.es"]');if(utterancesFrame){const utterancesTheme=theme==='dark'?'github-dark':'github-light';utterancesFrame.contentWindow.postMessage({type:'set-theme',theme:utterancesTheme},'https://utteranc.es');}}
function initializeUtterances(){const utterancesContainers=document.querySelectorAll('#utterances-container');utterancesContainers.forEach(container=>{const existingIframe=container.querySelector('iframe[src*="utteranc.es"]');if(!existingIframe){const repo=container.getAttribute('data-repo');const issueTerm=container.getAttribute('data-issue-term');const label=container.getAttribute('data-label');const currentTheme=getCurrentTheme();const theme=currentTheme==='dark'?'github-dark':'github-light';const script=document.createElement('script');script.src='https://utteranc.es/client.js';script.setAttribute('repo',repo);script.setAttribute('issue-term',issueTerm);script.setAttribute('label',label);script.setAttribute('theme',theme);script.setAttribute('crossorigin','anonymous');script.async=true;container.innerHTML='';container.appendChild(script);}});}
function createToggleButton(){const footer=document.querySelector('footer');if(!footer)return null;const toggleContainer=document.createElement('div');toggleContainer.className='theme-toggle-container';toggleContainer.innerHTML=`
            <span class="theme-toggle-text">[ 
                <span id="theme-light" class="theme-option">light mode</span> | 
                <span id="theme-dark" class="theme-option">dark mode</span> 
            ]</span>
        `;const lightOption=toggleContainer.querySelector('#theme-light');const darkOption=toggleContainer.querySelector('#theme-dark');lightOption.addEventListener('click',()=>setTheme('light'));darkOption.addEventListener('click',()=>setTheme('dark'));lightOption.addEventListener('keydown',function(e){if(e.key==='Enter'||e.key===' '){e.preventDefault();setTheme('light');}});darkOption.addEventListener('keydown',function(e){if(e.key==='Enter'||e.key===' '){e.preventDefault();setTheme('dark');}});lightOption.setAttribute('tabindex','0');darkOption.setAttribute('tabindex','0');footer.appendChild(toggleContainer);return toggleContainer;}
function initializeTheme(){const storedTheme=getStoredTheme();const systemTheme=getSystemTheme();const initialTheme=storedTheme||systemTheme;document.documentElement.setAttribute(THEME_ATTR,initialTheme);const toggleButton=createToggleButton();updateToggleButton(initialTheme);initializeUtterances();setTimeout(()=>updateUtterancesTheme(initialTheme),1000);window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change',function(e){if(!getStoredTheme()){const newTheme=e.matches?'dark':'light';document.documentElement.setAttribute(THEME_ATTR,newTheme);updateToggleButton(newTheme);const utterancesContainers=document.querySelectorAll('#utterances-container');utterancesContainers.forEach(container=>{container.innerHTML='';});initializeUtterances();updateUtterancesTheme(newTheme);}});}
window.initializeUtterances=initializeUtterances;if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',initializeTheme);}else{initializeTheme();}})();